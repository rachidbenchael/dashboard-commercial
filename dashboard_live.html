<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Commercial Live</title>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<style>
body { font-family: Arial; background:#f4f6f9; padding:20px; }
h1 { text-align:center; margin-bottom:30px; color:#333; }
.card { background:white; padding:20px; border-radius:10px; margin-bottom:30px; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
</style>
</head>
<body>

<h1>ðŸ“Š Dashboard Commercial Live</h1>

<div class="card">
<h3>ðŸ“ˆ Taux dâ€™atteinte (Calcul)</h3>
<div id="tableCalcul"></div>
</div>

<div class="card">
<h3>ðŸŽ¯ Objectifs</h3>
<div id="tableObjectifs"></div>
</div>

<div class="card">
<h3>ðŸš€ RÃ©alisations</h3>
<div id="tableRealisations"></div>
</div>

<div class="card">
<h3>ðŸ“Š Graphique Total BiÃ¨res vs Total Vin</h3>
<div id="chart_div"></div>
</div>

<script>
google.charts.load('current', {'packages':['table','corechart']});
google.charts.setOnLoadCallback(drawAll);

function drawAll() {
  // ---- TABLE CALCUL ----
  var queryCalcul = new google.visualization.Query(
    'https://docs.google.com/spreadsheets/d/1Vo4SDCb_udwvpx10lucyxWeiFiaDy-LhNjw0cB5cNOM/gviz/tq?sheet=Calcul&headers=1'
  );
  queryCalcul.send(function(response){
    if(response.isError()){ console.error(response.getMessage()); return; }
    var data = response.getDataTable();
    var table = new google.visualization.Table(document.getElementById('tableCalcul'));
    table.draw(data, {showRowNumber: true, width:'100%', height:'100%'});
  });

  // ---- TABLE OBJECTIFS ----
  var queryObj = new google.visualization.Query(
    'https://docs.google.com/spreadsheets/d/1Vo4SDCb_udwvpx10lucyxWeiFiaDy-LhNjw0cB5cNOM/gviz/tq?sheet=Objectifs&headers=1'
  );
  queryObj.send(function(response){
    if(response.isError()){ console.error(response.getMessage()); return; }
    var data = response.getDataTable();
    var table = new google.visualization.Table(document.getElementById('tableObjectifs'));
    table.draw(data, {showRowNumber: true, width:'100%', height:'100%'});
  });

  // ---- TABLE REALISATIONS ----
  var queryReal = new google.visualization.Query(
    'https://docs.google.com/spreadsheets/d/1Vo4SDCb_udwvpx10lucyxWeiFiaDy-LhNjw0cB5cNOM/gviz/tq?sheet=RÃ©alisations&headers=1'
  );
  queryReal.send(function(response){
    if(response.isError()){ console.error(response.getMessage()); return; }
    var data = response.getDataTable();
    var table = new google.visualization.Table(document.getElementById('tableRealisations'));
    table.draw(data, {showRowNumber: true, width:'100%', height:'100%'});

    // ---- CHART TOTAL BIERES vs TOTAL VIN ----
    var chartData = new google.visualization.DataTable();
    chartData.addColumn('string','Commerciale');
    chartData.addColumn('number','Total BiÃ¨res');
    chartData.addColumn('number','Total Vin');

    for(var i=0;i<data.getNumberOfRows();i++){
      chartData.addRow([
        data.getValue(i,1),   // Commerciale
        data.getValue(i,6),   // Total BiÃ¨res
        data.getValue(i,8)    // Total Vin
      ]);
    }

    var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
    chart.draw(chartData, {
      height: 400,
      colors: ['#36A2EB','#FF6384'],
      legend: { position: 'top' },
      hAxis: { title: 'Commerciale' },
      vAxis: { title: 'Montant' }
    });
  });
}
</script>

</body>
</html>
